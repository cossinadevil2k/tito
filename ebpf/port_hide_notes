# clang -O2 -target bpf -c port_hide.c -o port_hide.o

# bpftool prog load port_hide.o /sys/fs/bpf/hide_port type tc

# tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress bpf da obj port_hide.o sec tc

# tc filter show dev eth0 ingress
filter protocol all pref 49152 bpf chain 0 
filter protocol all pref 49152 bpf chain 0 handle 0x1 port_hide.o:[tc] direct-action not_in_hw id 109 name hide_port tag d4401dcbbaf845e1 jited 

Regarding the "Exclusivity flag on, cannot modify" error, you can fix this using:

tc qdisc del dev eth0 clsact

Then it will work. Remove with:

rm /sys/fs/bpf/hide_port
